---
- name: Generate locale
  command: /usr/sbin/locale-gen {{ locale }}

- name: Set locale
  command: /usr/sbin/update-locale LANG={{ locale }} LC_ALL={{ locale }} LANGUAGE={{ language }}

- name: Set /etc/localtime
  command: /bin/cp /usr/share/zoneinfo/{{ timezone }} /etc/localtime

- name: Set timezone (/etc/timezone)
  template: src=locale/timezone dest=/etc/timezone
  notify: update tzdata

- name: Install cron and ntpdate packages
  action: apt pkg={{ item }} state=installed
  with_items:
    - cron
    - ntpdate

- name: Configure ntpdate to syncronize time
  cron: name="Time synchronization" minute={{ 59|random }} user="root" job="/usr/sbin/ntpdate {{ ntp_server }}" cron_file=ntpdate
  notify: restart cron
